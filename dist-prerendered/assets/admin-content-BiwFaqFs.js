import{f as e,a as s,j as a,b as t,P as l,h as r,z as i}from"./ui-core-DIFKu14A.js";import{r as n}from"./react-core-CGKACH0y.js";import{c as d,B as o,E as c,W as h,Y as u,S as m,Q as g,V as x,s as p,a as j}from"./page-home-CQU8oqVu.js";import{u as v,I as b,S as f,d as w,e as y,f as k,g as _}from"./page-products-B7wMRW4G.js";import{L as N,T as C}from"./page-product-detail-BoFGybH8.js";import{D as S,a as E,b as P,c as A,d as q,e as F,T,f as B,g as O,h as z,i as D,j as V,k as M}from"./admin-main-DCIQnyrp.js";import{T as K,a as R,b as I,c as L}from"./admin-auth-DWhB8gXl.js";import{t as U}from"./page-contact-CfDnysdY.js";var $="Switch",[H,Q]=t($),[W,G]=H($),X=n.forwardRef((t,i)=>{const{__scopeSwitch:d,name:o,checked:c,defaultChecked:h,required:u,disabled:m,value:g="on",onCheckedChange:x,form:p,...j}=t,[v,b]=n.useState(null),f=e(i,e=>b(e)),w=n.useRef(!1),y=!v||p||!!v.closest("form"),[k=!1,_]=s({prop:c,defaultProp:h,onChange:x});return a.jsxs(W,{scope:d,checked:k,disabled:m,children:[a.jsx(l.button,{type:"button",role:"switch","aria-checked":k,"aria-required":u,"data-state":ee(k),"data-disabled":m?"":void 0,disabled:m,value:g,...j,ref:f,onClick:r(t.onClick,e=>{_(e=>!e),y&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())})}),y&&a.jsx(Z,{control:v,bubbles:!w.current,name:o,value:g,checked:k,required:u,disabled:m,form:p,style:{transform:"translateX(-100%)"}})]})});X.displayName=$;var Y="SwitchThumb",J=n.forwardRef((e,s)=>{const{__scopeSwitch:t,...r}=e,i=G(Y,t);return a.jsx(l.span,{"data-state":ee(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:s})});J.displayName=Y;var Z=e=>{const{control:s,checked:t,bubbles:l=!0,...r}=e,d=n.useRef(null),o=v(t),c=i(s);return n.useEffect(()=>{const e=d.current,s=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(s,"checked").set;if(o!==t&&a){const s=new Event("click",{bubbles:l});a.call(e,t),e.dispatchEvent(s)}},[o,t,l]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...r,tabIndex:-1,ref:d,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ee(e){return e?"checked":"unchecked"}var se=X,ae=J;const te=n.forwardRef(({className:e,...s},t)=>a.jsx(se,{className:d("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:t,children:a.jsx(ae,{className:d("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));te.displayName=se.displayName;const le={name:"",slug:"",url_et:"",sort_order:0,visible:!0,seo_title:"",seo_description:"",seo_keywords:""},re=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[e,s]=n.useState([]),[t,l]=n.useState([]),[r,i]=n.useState(!0),[d,j]=n.useState(!1),[v,f]=n.useState(le),[w,y]=n.useState(null),[k,_]=n.useState(!1),M=async()=>{i(!0);const{data:e,error:a}=await p.from("pages").select("id, name, slug, url_et, sort_order, visible, seo_title, seo_description, seo_keywords").order("sort_order",{ascending:!0});!a&&e&&s(e),i(!1)},$=async()=>{const{data:e,error:s}=await p.from("seo_metadata").select("*");!s&&e&&l(e)};n.useEffect(()=>{M(),$()},[]);const H=async(s,a)=>{let t=[...e];if("up"===a&&s>0)[t[s-1],t[s]]=[t[s],t[s-1]];else{if("down"!==a||s>=t.length-1)return;[t[s],t[s+1]]=[t[s+1],t[s]]}t=t.map((e,s)=>({...e,sort_order:s})),await Promise.all(t.map(e=>p.from("pages").update({sort_order:e.sort_order}).eq("id",e.id))),M()};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Main Menu Pages"}),a.jsxs(S,{open:d,onOpenChange:j,children:[a.jsx(E,{asChild:!0,children:a.jsxs(o,{className:"bg-red-600 hover:bg-red-700",children:[a.jsx(c,{className:"mr-2 h-4 w-4"})," Add Page"]})}),a.jsxs(P,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[a.jsx(A,{children:a.jsx(q,{children:w?"Edit Page":"Add New Page"})}),a.jsxs(K,{defaultValue:"basic",className:"w-full",children:[a.jsxs(R,{className:"grid w-full grid-cols-2",children:[a.jsx(I,{value:"basic",children:"Basic Info"}),a.jsx(I,{value:"seo",children:"SEO Settings"})]}),a.jsxs(L,{value:"basic",className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"name",children:"Name (Estonian)"}),a.jsx(b,{id:"name",value:v.name||"",onChange:e=>f({...v,name:e.target.value}),placeholder:"e.g. Avaleht"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"slug",children:"Slug"}),a.jsx(b,{id:"slug",value:v.slug||"",onChange:e=>f({...v,slug:e.target.value}),placeholder:"e.g. avaleht"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"url_et",children:"URL (Estonian)"}),a.jsx(b,{id:"url_et",value:v.url_et||"",onChange:e=>f({...v,url_et:e.target.value}),placeholder:"e.g. /avaleht"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"visible",children:"Visible in Menu"}),a.jsx(te,{id:"visible",checked:v.visible??!0,onCheckedChange:e=>f({...v,visible:e})})]})]}),a.jsxs(L,{value:"seo",className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"seo_title",children:"SEO Title"}),a.jsx(b,{id:"seo_title",value:v.seo_title||"",onChange:e=>f({...v,seo_title:e.target.value}),placeholder:"e.g. Leatex - Kvaliteetsed kotid ja pakendid"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Title that appears in search results and browser tabs (50-60 characters recommended)"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"seo_description",children:"SEO Description"}),a.jsx(C,{id:"seo_description",value:v.seo_description||"",onChange:e=>f({...v,seo_description:e.target.value}),placeholder:"e.g. Kvaliteetsed puuvillakotid, paberkotid, paelaga kotid ja pakendid kohandatud trükiga. Küsi pakkumist juba täna!",rows:3}),a.jsx("p",{className:"text-sm text-gray-500",children:"Description that appears in search results (150-160 characters recommended)"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(N,{htmlFor:"seo_keywords",children:"SEO Keywords"}),a.jsx(b,{id:"seo_keywords",value:v.seo_keywords||"",onChange:e=>f({...v,seo_keywords:e.target.value}),placeholder:"e.g. kotid, pakendid, puuvillakotid, paberkotid"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Keywords separated by commas (optional, but can help with SEO)"})]})]})]}),a.jsxs(F,{children:[a.jsx(o,{variant:"outline",onClick:()=>{j(!1),f(le),y(null)},children:"Cancel"}),a.jsx(o,{className:"bg-red-600 hover:bg-red-700",onClick:async()=>{if(_(!0),!v.name||!v.url_et)return U({title:"Missing fields",description:"Name and URL are required.",variant:"destructive"}),void _(!1);let s=v.slug;(""===s||"avaleht"===s||"Main page"===s||v.name&&v.name.toLowerCase().includes("avaleht")||v.name&&v.name.toLowerCase().includes("main"))&&(s="home");try{if(w){const{error:e}=await p.from("pages").update({name:v.name,slug:s,url_et:v.url_et,sort_order:v.sort_order,visible:v.visible}).eq("id",w);if(e)throw e;const a=t.find(e=>e.page===s);if(a){const{error:e}=await p.from("seo_metadata").update({title:v.seo_title||null,description:v.seo_description||null,keywords:v.seo_keywords||null}).eq("id",a.id);if(e)throw e}else{const{error:e}=await p.from("seo_metadata").insert({page:s,title:v.seo_title||null,description:v.seo_description||null,keywords:v.seo_keywords||null});if(e)throw e}U({title:"Page updated successfully"})}else{const a=e.length>0?Math.max(...e.map(e=>e.sort_order||0)):0,{error:t}=await p.from("pages").insert({name:v.name,slug:s,url_et:v.url_et,sort_order:a+1,visible:v.visible??!0});if(t)throw t;if(v.seo_title||v.seo_description||v.seo_keywords){const{error:e}=await p.from("seo_metadata").insert({page:s,title:v.seo_title||null,description:v.seo_description||null,keywords:v.seo_keywords||null});if(e)throw e}U({title:"Page added successfully"})}}catch(a){U({title:"Error saving page",description:a.message,variant:"destructive"})}_(!1),j(!1),M(),$()},disabled:k,children:w?"Save Changes":"Add Page"})]})]})]})]}),r?a.jsx("div",{className:"flex justify-center p-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-600"})}):a.jsx("div",{className:"bg-white rounded-md border",children:a.jsxs(T,{children:[a.jsx(B,{children:a.jsxs(O,{children:[a.jsx(z,{children:"Order"}),a.jsx(z,{children:"Name"}),a.jsx(z,{children:"Slug"}),a.jsx(z,{children:"URL"}),a.jsx(z,{children:"SEO"}),a.jsx(z,{children:"Visible"}),a.jsx(z,{className:"text-right",children:"Actions"})]})}),a.jsx(D,{children:0===e.length?a.jsx(O,{children:a.jsx(V,{colSpan:7,className:"text-center py-6 text-gray-500",children:"No pages found"})}):e.map((s,l)=>{const r=t.some(e=>e.page===s.slug);return a.jsxs(O,{children:[a.jsx(V,{children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(o,{variant:"ghost",size:"icon",onClick:()=>H(l,"up"),disabled:0===l,children:a.jsx(h,{className:"h-4 w-4"})}),a.jsx(o,{variant:"ghost",size:"icon",onClick:()=>H(l,"down"),disabled:l===e.length-1,children:a.jsx(u,{className:"h-4 w-4"})}),s.sort_order]})}),a.jsx(V,{children:s.name}),a.jsx(V,{children:s.slug}),a.jsx(V,{children:s.url_et}),a.jsx(V,{children:r?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(m,{className:"h-3 w-3 mr-1"}),"Configured"]}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Not set"})}),a.jsx(V,{children:a.jsx(te,{checked:s.visible,onCheckedChange:e=>(async(e,s)=>{await p.from("pages").update({visible:s}).eq("id",e),M()})(s.id,e)})}),a.jsx(V,{className:"text-right",children:a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(o,{variant:"outline",size:"sm",onClick:()=>(e=>{if(e){const s=""===e.slug||"avaleht"===e.slug||"Main page"===e.slug||e.name.toLowerCase().includes("avaleht")||e.name.toLowerCase().includes("main")?"home":e.slug,a=t.find(e=>e.page===s);f({...e,slug:s,seo_title:a?.title||"",seo_description:a?.description||"",seo_keywords:a?.keywords||""}),y(e.id)}else f(le),y(null);j(!0)})(s),children:a.jsx(g,{className:"h-4 w-4"})}),a.jsx(o,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>(async e=>{if(!window.confirm("Delete this page?"))return;const{error:s}=await p.from("pages").delete().eq("id",e);U(s?{title:"Error deleting page",description:s.message,variant:"destructive"}:{title:"Page deleted"}),M()})(s.id),children:a.jsx(x,{className:"h-4 w-4"})})]})})]},s.id)})})]})})]})}},Symbol.toStringTag,{value:"Module"})),ie=async()=>[{value:"home",label:"Homepage"},{value:"products",label:"Tooted (Products)"},{value:"cotton-bags",label:"Riidest kotid (Cotton Bags)"},{value:"paper-bags",label:"Paberkotid (Paper Bags)"},{value:"drawstring-bags",label:"Nööriga kotid (Drawstring Bags)"},{value:"shoebags",label:"Sussikotid (Shoe Bags)"},{value:"contact",label:"Kontakt (Contact)"},{value:"about",label:"Meist (About)"},{value:"portfolio",label:"Portfoolio (Portfolio)"},{value:"blog",label:"Blogi (Blog)"},{value:"admin",label:"Admin"},{value:"inquiry",label:"Inquiry"},{value:"global",label:"Global (All Pages)"}],ne=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[e,s]=n.useState([]),[t,l]=n.useState([]),[r,i]=n.useState([]),[d,h]=n.useState(!0),[u,m]=n.useState(null),[v,N]=n.useState(null),[K,R]=n.useState(!1),[I,L]=n.useState(!1),[$,H]=n.useState(!1),[Q,W]=n.useState(!1),[G,X]=n.useState({key:"",value:"",page:""}),[Y,J]=n.useState({title:"",excerpt:"",image_url:"",read_time:""}),[Z,ee]=n.useState(null),[se,ae]=n.useState(""),[te,le]=n.useState("all"),[re,ne]=n.useState([]),[de,oe]=n.useState(null),ce=async()=>{try{h(!0);const{data:e,error:a}=await p.from("website_content").select("*");if(a)throw a;e&&s(e)}catch(e){U({title:"Error loading content",description:e.message,variant:"destructive"})}finally{h(!1)}},he=async()=>{try{const{data:e,error:s}=await p.from("featured_blog_posts").select("*").order("created_at",{ascending:!1});if(s)throw s;l(e||[])}catch(e){U({title:"Error loading featured blog posts",description:e.message,variant:"destructive"})}},ue=async()=>{try{if(!Z)return;const{error:a}=await p.from("website_content").update({value:se}).eq("id",Z);if(a)throw a;U({title:"Content updated",description:"Content item has been successfully updated"}),s(e.map(e=>e.id===Z?{...e,value:se}:e)),ee(null),ae("")}catch(a){U({title:"Error updating content",description:a.message,variant:"destructive"})}},me="all"===te?e:e.filter(e=>e.page===te),ge=Array.from(new Set(e.map(e=>e.page)));return n.useEffect(()=>{ce(),he(),(async()=>{const e=await ie();i(e)})(),(async()=>{const{data:e,error:s}=await p.from("website_content").select("key").order("key",{ascending:!0});if(!s&&e){const s=Array.from(new Set(e.map(e=>e.key)));ne(s)}})()},[]),n.useEffect(()=>{K&&!G.key&&re.length>0&&X(e=>({...e,key:re[0]}))},[K,re]),a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Website Content"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{htmlFor:"page-filter",className:"text-sm font-medium",children:"Filter by page:"}),a.jsxs(f,{value:te,onValueChange:le,children:[a.jsx(w,{className:"w-40",children:a.jsx(y,{placeholder:"All pages"})}),a.jsxs(k,{children:[a.jsx(_,{value:"all",children:"All pages"}),ge.map(e=>a.jsx(_,{value:e,children:e},e))]})]})]}),a.jsxs(S,{open:K,onOpenChange:R,children:[a.jsx(E,{asChild:!0,children:a.jsxs(o,{className:"bg-red-600 hover:bg-red-700",children:[a.jsx(c,{className:"mr-2 h-4 w-4"})," Add New Content"]})}),a.jsxs(P,{className:"sm:max-w-[500px]",children:[a.jsxs(A,{children:[a.jsx(q,{children:u?"Edit Content Item":"Add New Content Item"}),a.jsxs(M,{children:["Complete the fields to ",u?"edit":"add"," a content item."]})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"key",children:"Content Key"}),a.jsxs(f,{value:G.key||"",onValueChange:e=>X({...G,key:e}),children:[a.jsx(w,{children:a.jsx(y,{placeholder:"Select or type a key"})}),a.jsx(k,{children:re.filter(e=>"string"==typeof e&&""!==e.trim()).map(e=>a.jsx(_,{value:e,children:e},e))})]}),a.jsx(b,{id:"key",value:G.key,onChange:e=>X({...G,key:e.target.value}),placeholder:"Example: homepage_title",className:"mt-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"The key is a unique identifier used to display content on the page."})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"page",children:"Page"}),a.jsxs(f,{value:G.page,onValueChange:e=>X({...G,page:e}),children:[a.jsx(w,{children:a.jsx(y,{placeholder:"Select a page"})}),a.jsx(k,{children:r.map(e=>a.jsx(_,{value:e.value,children:e.label},e.value))})]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Select the page where the content will be displayed."})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"value",children:"Content Value"}),a.jsx(C,{id:"value",value:G.value,onChange:e=>X({...G,value:e.target.value}),placeholder:"Enter content text",rows:5})]})]}),a.jsxs(F,{children:[a.jsx(o,{variant:"outline",onClick:()=>{R(!1),m(null),X({key:"",value:"",page:""})},children:"Cancel"}),a.jsx(o,{className:"bg-red-600 hover:bg-red-700",onClick:u?async()=>{try{if(!u||!G.key||!G.page)return void U({title:"Validation error",description:"Key and page are required fields",variant:"destructive"});const{error:e}=await p.from("website_content").update({key:G.key,value:G.value||"",page:G.page}).eq("id",u.id);if(e)throw e;U({title:"Content updated",description:"Content item has been successfully updated"}),X({key:"",value:"",page:""}),m(null),R(!1),await ce()}catch(e){U({title:"Error updating content",description:e.message,variant:"destructive"})}}:async()=>{try{if(!G.key||!G.page)return void U({title:"Validation error",description:"Key and page are required fields",variant:"destructive"});const{data:e,error:s}=await p.from("website_content").insert({key:G.key,value:G.value||"",page:G.page}).select();if(s)throw s;U({title:"Content added",description:"Content item has been successfully added"}),X({key:"",value:"",page:""}),R(!1),await ce()}catch(e){U({title:"Error adding content",description:e.message,variant:"destructive"})}},children:u?"Save Changes":"Add Content"})]})]})]}),a.jsx(S,{open:$,onOpenChange:H,children:a.jsxs(P,{children:[a.jsxs(A,{children:[a.jsx(q,{children:"Delete Content Item"}),a.jsx(M,{children:"Are you sure you want to delete this content item? This action cannot be undone."})]}),a.jsxs(F,{children:[a.jsx(o,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),a.jsx(o,{variant:"destructive",onClick:async()=>{try{if(!u)return;const{error:e}=await p.from("website_content").delete().eq("id",u.id);if(e)throw e;U({title:"Content deleted",description:"Content item has been successfully deleted"}),H(!1),m(null),await ce()}catch(e){U({title:"Error deleting content",description:e.message,variant:"destructive"})}},children:"Delete"})]})]})})]}),a.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Quick Add - /tooted Page Content"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(o,{variant:"outline",size:"sm",onClick:()=>{X({key:"tooted_page_heading",value:"Meie tooted",page:"tooted"}),R(!0)},children:"Add Page Heading"}),a.jsx(o,{variant:"outline",size:"sm",onClick:()=>{X({key:"tooted_page_description",value:"Sirvige laia valikut kotte ja pakendeid, mida saate kohandada vastavalt oma brändi vajadustele.",page:"tooted"}),R(!0)},children:"Add Page Description"}),a.jsx(o,{variant:"outline",size:"sm",onClick:()=>{X({key:"tooted_blog_section_title",value:"Kasulikud artiklid",page:"tooted"}),R(!0)},children:"Add Blog Section Title"})]})]}),d?a.jsx("div",{className:"flex justify-center p-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-600"})}):a.jsx("div",{className:"bg-white rounded-md border",children:a.jsxs(T,{children:[a.jsx(B,{children:a.jsxs(O,{children:[a.jsx(z,{children:"Key"}),a.jsx(z,{children:"Page"}),a.jsx(z,{children:"Value"}),a.jsx(z,{className:"text-right",children:"Actions"})]})}),a.jsx(D,{children:0===me.length?a.jsx(O,{children:a.jsx(V,{colSpan:4,className:"text-center py-6 text-gray-500",children:"No content items added"})}):me.map(e=>a.jsxs(O,{children:[a.jsx(V,{className:"font-medium",children:e.key}),a.jsx(V,{children:e.page}),a.jsx(V,{className:"max-w-md",children:Z===e.id?a.jsxs("div",{className:"flex items-center",children:[a.jsx(C,{value:se,onChange:e=>ae(e.target.value),className:"mr-2",rows:3}),a.jsx(o,{variant:"ghost",size:"sm",onClick:ue,className:"text-green-600",children:a.jsx(j,{className:"h-4 w-4"})})]}):a.jsx("div",{className:"whitespace-pre-wrap break-words",children:e.value})}),a.jsx(V,{className:"text-right",children:a.jsxs("div",{className:"flex justify-end gap-2",children:[Z!==e.id&&a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>(e=>{ee(e.id),ae(e.value)})(e),children:[a.jsx(g,{className:"h-4 w-4 mr-1"})," Edit Text"]}),a.jsx(o,{variant:"outline",size:"sm",onClick:()=>(e=>{m(e),X({key:e.key,value:e.value,page:e.page}),R(!0)})(e),children:a.jsx(g,{className:"h-4 w-4"})}),a.jsx(o,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>(e=>{m(e),H(!0)})(e),children:a.jsx(x,{className:"h-4 w-4"})})]})})]},e.id))})]})}),a.jsxs("div",{className:"mt-12",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Featured Blog Posts"}),a.jsxs(S,{open:I,onOpenChange:L,children:[a.jsx(E,{asChild:!0,children:a.jsxs(o,{className:"bg-blue-600 hover:bg-blue-700",children:[a.jsx(c,{className:"mr-2 h-4 w-4"})," Add Blog Post"]})}),a.jsxs(P,{className:"sm:max-w-[600px]",children:[a.jsxs(A,{children:[a.jsx(q,{children:v?"Edit Blog Post":"Add New Blog Post"}),a.jsx(M,{children:"Featured blog posts appear on the /tooted page."})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"blog-title",children:"Title"}),a.jsx(b,{id:"blog-title",value:Y.title,onChange:e=>J({...Y,title:e.target.value}),placeholder:"Blog post title"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"blog-excerpt",children:"Excerpt"}),a.jsx(C,{id:"blog-excerpt",value:Y.excerpt,onChange:e=>J({...Y,excerpt:e.target.value}),placeholder:"Brief description of the blog post",rows:3})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"blog-read-time",children:"Read Time"}),a.jsx(b,{id:"blog-read-time",value:Y.read_time,onChange:e=>J({...Y,read_time:e.target.value}),placeholder:"e.g., 5 min"})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx("label",{htmlFor:"blog-image",children:"Image"}),a.jsx(b,{id:"blog-image",type:"file",accept:"image/*",onChange:e=>{const s=e.target.files?.[0];s&&oe(s)}}),Y.image_url&&!de&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Current image:"}),a.jsx("img",{src:Y.image_url,alt:"Current",className:"w-32 h-20 object-cover rounded"})]})]})]}),a.jsxs(F,{children:[a.jsx(o,{variant:"outline",onClick:()=>{L(!1),N(null),J({title:"",excerpt:"",image_url:"",read_time:""}),oe(null)},children:"Cancel"}),a.jsx(o,{className:"bg-blue-600 hover:bg-blue-700",onClick:v?async()=>{try{if(!v||!Y.title||!Y.excerpt)return void U({title:"Validation error",description:"Title and excerpt are required fields",variant:"destructive"});let e=v.image_url;if(de){const s=`${Date.now()}-${de.name.replace(/\s+/g,"-")}`,{data:a,error:t}=await p.storage.from("site-assets").upload("blog/"+s,de);if(t)throw t;const{data:l}=p.storage.from("site-assets").getPublicUrl("blog/"+s);e=l.publicUrl}const{error:s}=await p.from("featured_blog_posts").update({title:Y.title,excerpt:Y.excerpt,image_url:e,read_time:Y.read_time||"5 min"}).eq("id",v.id);if(s)throw s;U({title:"Blog post updated",description:"Featured blog post has been successfully updated"}),J({title:"",excerpt:"",image_url:"",read_time:""}),N(null),oe(null),L(!1),await he()}catch(e){U({title:"Error updating blog post",description:e.message,variant:"destructive"})}}:async()=>{try{if(!Y.title||!Y.excerpt)return void U({title:"Validation error",description:"Title and excerpt are required fields",variant:"destructive"});let e=Y.image_url;if(de){const s=`${Date.now()}-${de.name.replace(/\s+/g,"-")}`,{data:a,error:t}=await p.storage.from("site-assets").upload("blog/"+s,de);if(t)throw t;const{data:l}=p.storage.from("site-assets").getPublicUrl("blog/"+s);e=l.publicUrl}const{data:s,error:a}=await p.from("featured_blog_posts").insert({title:Y.title,excerpt:Y.excerpt,image_url:e,read_time:Y.read_time||"5 min"}).select();if(a)throw a;U({title:"Blog post added",description:"Featured blog post has been successfully added"}),J({title:"",excerpt:"",image_url:"",read_time:""}),oe(null),L(!1),await he()}catch(e){U({title:"Error adding blog post",description:e.message,variant:"destructive"})}},children:v?"Save Changes":"Add Blog Post"})]})]})]})]}),a.jsx("div",{className:"bg-white rounded-md border",children:a.jsxs(T,{children:[a.jsx(B,{children:a.jsxs(O,{children:[a.jsx(z,{children:"Image"}),a.jsx(z,{children:"Title"}),a.jsx(z,{children:"Excerpt"}),a.jsx(z,{children:"Read Time"}),a.jsx(z,{className:"text-right",children:"Actions"})]})}),a.jsx(D,{children:0===t.length?a.jsx(O,{children:a.jsx(V,{colSpan:5,className:"text-center py-6 text-gray-500",children:"No featured blog posts added"})}):t.map(e=>a.jsxs(O,{children:[a.jsx(V,{children:e.image_url&&a.jsx("img",{src:e.image_url,alt:e.title,className:"w-16 h-12 object-cover rounded"})}),a.jsx(V,{className:"font-medium",children:e.title}),a.jsx(V,{className:"max-w-md",children:a.jsx("div",{className:"whitespace-pre-wrap break-words",children:e.excerpt})}),a.jsx(V,{children:e.read_time}),a.jsx(V,{className:"text-right",children:a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>(e=>{N(e),J({title:e.title,excerpt:e.excerpt,image_url:e.image_url,read_time:e.read_time}),L(!0)})(e),children:a.jsx(g,{className:"h-4 w-4"})}),a.jsx(o,{variant:"ghost",size:"sm",onClick:()=>(e=>{N(e),W(!0)})(e),className:"text-red-600 hover:text-red-700",children:a.jsx(x,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),a.jsx(S,{open:Q,onOpenChange:W,children:a.jsxs(P,{children:[a.jsxs(A,{children:[a.jsx(q,{children:"Delete Blog Post"}),a.jsx(M,{children:"Are you sure you want to delete this featured blog post? This action cannot be undone."})]}),a.jsxs(F,{children:[a.jsx(o,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),a.jsx(o,{variant:"destructive",onClick:async()=>{try{if(!v)return;const{error:e}=await p.from("featured_blog_posts").delete().eq("id",v.id);if(e)throw e;U({title:"Blog post deleted",description:"Featured blog post has been successfully deleted"}),W(!1),N(null),await he()}catch(e){U({title:"Error deleting blog post",description:e.message,variant:"destructive"})}},children:"Delete"})]})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{ne as C,re as P,te as S,ie as f};
