import{j as e}from"./ui-core-DIFKu14A.js";import{r as s}from"./react-core-CGKACH0y.js";import{B as t,V as a,s as r}from"./page-home-CQU8oqVu.js";import{I as i}from"./page-products-B7wMRW4G.js";import{L as o}from"./page-product-detail-BoFGybH8.js";import{t as n}from"./page-contact-CfDnysdY.js";import"./router-Enmi9DRI.js";import"./data-BmXeSXkP.js";const l="ordering_faq",c=()=>{const[c,d]=s.useState([]),[m,u]=s.useState(!0),[p,f]=s.useState(!1),[x,j]=s.useState(!1);s.useEffect(()=>{(async()=>{u(!0);const{data:e}=await r.from("website_content").select("key, value").eq("page","product_faq");if(e){const s=[];e.forEach(e=>{const t=e.key.match(/^ordering_faq_(\d+)_(question|answer)$/);if(t){const a=parseInt(t[1]),r=t[2];s[a]||(s[a]={question:"",answer:""}),s[a][r]=e.value}}),d(s.filter(e=>e&&(e.question||e.answer)))}u(!1)})()},[]);const v=(e,s,t)=>{d(a=>a.map((a,r)=>r===e?{...a,[s]:t}:a))};return e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Product FAQ (Tellimisprotsessi KKK)"}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),f(!0),j(!1);const s=c.flatMap((e,s)=>[{page:"product_faq",key:`${l}_${s}_question`,value:e.question},{page:"product_faq",key:`${l}_${s}_answer`,value:e.answer}]).filter(e=>""!==e.value.trim()),{error:t}=await r.from("website_content").upsert(s,{onConflict:"page,key"});f(!1),t?n({title:"Error",description:"Failed to save FAQ: "+t.message,variant:"destructive"}):(j(!0),n({title:"Success",description:"Product FAQ updated successfully"}))},children:[e.jsx("div",{className:"space-y-4",children:c.map((s,r)=>e.jsxs("div",{className:"border rounded p-4 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"font-medium",children:["KKK #",r+1]}),e.jsx(t,{type:"button",variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>(e=>{d(s=>s.filter((s,t)=>t!==e))})(r),disabled:m||p,children:e.jsx(a,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"block text-sm font-medium mb-1",children:"Küsimus"}),e.jsx(i,{type:"text",className:"w-full border rounded px-3 py-2",value:s.question,onChange:e=>v(r,"question",e.target.value),disabled:m||p})]}),e.jsxs("div",{children:[e.jsx(o,{className:"block text-sm font-medium mb-1",children:"Vastus"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2",rows:3,value:s.answer,onChange:e=>v(r,"answer",e.target.value),disabled:m||p})]})]})]},r))}),e.jsx(t,{type:"button",variant:"outline",className:"mt-6",onClick:()=>{d(e=>[...e,{question:"",answer:""}])},disabled:m||p,children:"Lisa uus KKK"}),e.jsx(t,{type:"submit",className:"mt-6 ml-4",disabled:m||p,children:p?"Salvestan...":"Salvesta kõik"}),x&&e.jsx("div",{className:"text-green-600 mt-2",children:"Salvestatud!"})]})]})};export{c as default};
