import{j as e,u as a,a as s,b as t,d as i,P as r,q as n,r as o,I as l,h as d,p as c}from"./ui-core-DIFKu14A.js";import{r as u}from"./react-core-CGKACH0y.js";import{s as m,c as g,n as p,w as h,x as f,y as v,o as b,B as x,z as j}from"./page-home-CQU8oqVu.js";import{t as y}from"./page-contact-CfDnysdY.js";import{b as w,N}from"./router-Enmi9DRI.js";import{I as S}from"./page-products-B7wMRW4G.js";import{L as I}from"./page-product-detail-BoFGybH8.js";const C=u.createContext(void 0),T=({children:a})=>{const[s,t]=u.useState(null),[i,r]=u.useState(null),[n,o]=u.useState(!0),l=w();u.useEffect(()=>{const{data:{subscription:e}}=m.auth.onAuthStateChange(async(e,a)=>{r(a),t(a?.user??null),"SIGNED_IN"===e?(y({title:"Tere tulemast!",description:"Olete edukalt sisse logitud."}),"/admin/login"!==window.location.pathname&&"/admin/register"!==window.location.pathname||setTimeout(()=>{l("/admin")},0)):"SIGNED_OUT"===e&&(y({title:"V채lja logitud",description:"Olete edukalt v채lja logitud."}),setTimeout(()=>{l("/admin/login")},0))});return(async()=>{try{const{data:{session:e},error:a}=await m.auth.getSession();a?d():(r(e),t(e?.user??null))}catch(e){d()}finally{o(!1)}})(),()=>{e.unsubscribe()}},[l]);const d=()=>{localStorage.removeItem("supabase.auth.token"),Object.keys(localStorage).forEach(e=>{(e.startsWith("supabase.auth.")||e.includes("sb-"))&&localStorage.removeItem(e)}),Object.keys(sessionStorage||{}).forEach(e=>{(e.startsWith("supabase.auth.")||e.includes("sb-"))&&sessionStorage.removeItem(e)})};return e.jsx(C.Provider,{value:{user:s,session:i,loading:n,signIn:async(e,a)=>{try{o(!0),d();try{await m.auth.signOut({scope:"global"})}catch(s){}const{data:i,error:n}=await m.auth.signInWithPassword({email:e,password:a});if(n)throw n;i.user&&i.session&&(t(i.user),r(i.session))}catch(i){y({title:"Viga sisselogimisel",description:i.message||"Kontrollige oma e-posti ja parooli",variant:"destructive"})}finally{o(!1)}},signUp:async(e,a)=>{try{o(!0),d();const{data:s,error:t}=await m.auth.signUp({email:e,password:a});if(t)throw t;y({title:"Konto loomine 천nnestus",description:"Palun kontrollige oma e-posti kontot kinnituslingi jaoks."})}catch(s){y({title:"Viga konto loomisel",description:s.message,variant:"destructive"})}finally{o(!1)}},signOut:async()=>{try{o(!0),d(),await m.auth.signOut({scope:"global"}),t(null),r(null)}catch(e){y({title:"Viga v채ljalogimisel",description:e.message,variant:"destructive"})}finally{o(!1)}}},children:a})},k=()=>{const e=u.useContext(C);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};var _="Tabs",[R,V]=t(_,[n]),D=n(),[E,O]=R(_),P=u.forwardRef((t,n)=>{const{__scopeTabs:o,value:l,onValueChange:d,defaultValue:c,orientation:u="horizontal",dir:m,activationMode:g="automatic",...p}=t,h=a(m),[f,v]=s({prop:l,onChange:d,defaultProp:c});return e.jsx(E,{scope:o,baseId:i(),value:f,onValueChange:v,orientation:u,dir:h,activationMode:g,children:e.jsx(r.div,{dir:h,"data-orientation":u,...p,ref:n})})});P.displayName=_;var F="TabsList",A=u.forwardRef((a,s)=>{const{__scopeTabs:t,loop:i=!0,...n}=a,l=O(F,t),d=D(t);return e.jsx(o,{asChild:!0,...d,orientation:l.orientation,dir:l.dir,loop:i,children:e.jsx(r.div,{role:"tablist","aria-orientation":l.orientation,...n,ref:s})})});A.displayName=F;var M="TabsTrigger",q=u.forwardRef((a,s)=>{const{__scopeTabs:t,value:i,disabled:n=!1,...o}=a,c=O(M,t),u=D(t),m=U(c.baseId,i),g=$(c.baseId,i),p=i===c.value;return e.jsx(l,{asChild:!0,...u,focusable:!n,active:p,children:e.jsx(r.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":g,"data-state":p?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:m,...o,ref:s,onMouseDown:d(a.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(i)}),onKeyDown:d(a.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(i)}),onFocus:d(a.onFocus,()=>{const e="manual"!==c.activationMode;p||n||!e||c.onValueChange(i)})})})});q.displayName=M;var L="TabsContent",K=u.forwardRef((a,s)=>{const{__scopeTabs:t,value:i,forceMount:n,children:o,...l}=a,d=O(L,t),m=U(d.baseId,i),g=$(d.baseId,i),p=i===d.value,h=u.useRef(p);return u.useEffect(()=>{const e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),e.jsx(c,{present:n||p,children:({present:t})=>e.jsx(r.div,{"data-state":p?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":m,hidden:!t,id:g,tabIndex:0,...l,ref:s,style:{...a.style,animationDuration:h.current?"0s":void 0},children:t&&o})})});function U(e,a){return`${e}-trigger-${a}`}function $(e,a){return`${e}-content-${a}`}K.displayName=L;var z=A,W=q,G=K;const B=P,H=u.forwardRef(({className:a,...s},t)=>e.jsx(z,{ref:t,className:g("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s}));H.displayName=z.displayName;const J=u.forwardRef(({className:a,...s},t)=>e.jsx(W,{ref:t,className:g("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s}));J.displayName=W.displayName;const Q=u.forwardRef(({className:a,...s},t)=>e.jsx(G,{ref:t,className:g("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s}));Q.displayName=G.displayName;const X=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{user:a,loading:s,signIn:t,signUp:i}=k(),[r,n]=u.useState(""),[o,l]=u.useState(""),[d,c]=u.useState(!1);return s?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mx-auto"}),e.jsx("p",{className:"mt-4",children:"Loading..."})]})}):a?e.jsx(N,{to:"/admin",replace:!0}):e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs(p,{className:"w-[400px]",children:[e.jsxs(h,{className:"text-center",children:[e.jsx(f,{className:"text-2xl font-bold text-red-600",children:"Admin Panel"}),e.jsx(v,{children:"Sign in to continue"})]}),e.jsx(b,{children:e.jsxs(B,{defaultValue:"login",children:[e.jsxs(H,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(J,{value:"login",children:"Login"}),e.jsx(J,{value:"register",children:"Register"})]}),e.jsx(Q,{value:"login",children:e.jsx("form",{onSubmit:async e=>{e.preventDefault(),c(!0),await t(r,o),c(!1)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"email",children:"Email"}),e.jsx(S,{id:"email",type:"email",placeholder:"your@email.com",value:r,onChange:e=>n(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"password",children:"Password"}),e.jsx(S,{id:"password",type:"password",value:o,onChange:e=>l(e.target.value),required:!0})]}),e.jsx(x,{className:"w-full bg-red-600 hover:bg-red-700",type:"submit",disabled:d,children:d?"Signing in...":"Sign in"})]})})}),e.jsx(Q,{value:"register",children:e.jsx("form",{onSubmit:async e=>{e.preventDefault(),c(!0),await i(r,o),c(!1)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"register-email",children:"Email"}),e.jsx(S,{id:"register-email",type:"email",placeholder:"your@email.com",value:r,onChange:e=>n(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"register-password",children:"Password"}),e.jsx(S,{id:"register-password",type:"password",value:o,onChange:e=>l(e.target.value),required:!0})]}),e.jsx(x,{className:"w-full bg-red-600 hover:bg-red-700",type:"submit",disabled:d,children:d?"Registering...":"Register"})]})})})]})}),e.jsx(j,{className:"text-center text-sm text-gray-500",children:"Leatex.ee admin panel"})]})})}},Symbol.toStringTag,{value:"Module"}));export{T as A,X as L,B as T,H as a,J as b,Q as c,k as u};
