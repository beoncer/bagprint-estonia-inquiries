import{j as e}from"./ui-core-DIFKu14A.js";import{r}from"./react-core-CGKACH0y.js";import{s as a,B as i,ab as s,ar as t,E as n,Q as l,V as d}from"./page-home-CQU8oqVu.js";import{I as c,S as o,d as h,e as m,f as p,g as u}from"./page-products-B7wMRW4G.js";import{t as x}from"./page-contact-CfDnysdY.js";import{D as j,a as y,b as g,c as f,d as v,k as w,e as b,T as N,f as S,g as q,h as E,i as C,j as k,B as _}from"./admin-main-DCIQnyrp.js";import{S as F}from"./admin-content-BiwFaqFs.js";import"./router-Enmi9DRI.js";import"./data-BmXeSXkP.js";import"./page-product-detail-BoFGybH8.js";import"./admin-auth-DWhB8gXl.js";const L=()=>{const[L,A]=r.useState([]),[D,R]=r.useState(!0),[U,M]=r.useState(null),[P,V]=r.useState(!1),[W,z]=r.useState(!1),[B,G]=r.useState({url:"",priority:.5,changefreq:"weekly"});r.useEffect(()=>{T()},[]);const T=async()=>{try{R(!0);const{data:e,error:r}=await a.from("sitemap_entries").select("*").order("priority",{ascending:!1});if(r)throw r;e&&A(e)}catch(e){x({title:"Error loading sitemap entries",description:e.message,variant:"destructive"})}finally{R(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sitemap Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage URLs included in your website's sitemap"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:async()=>{try{z(!0);const{data:e,error:r}=await a.functions.invoke("generate-sitemap");if(r)throw r;x({title:"Sitemap generated",description:"Static sitemap.xml has been updated successfully"}),await T()}catch(e){x({title:"Error generating sitemap",description:e.message,variant:"destructive"})}finally{z(!1)}},disabled:W,className:"bg-green-600 hover:bg-green-700",children:W?e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"mr-2 h-4 w-4"}),"Generate Sitemap"]})}),e.jsxs(j,{open:P,onOpenChange:V,children:[e.jsx(y,{asChild:!0,children:e.jsxs(i,{className:"bg-red-600 hover:bg-red-700",children:[e.jsx(n,{className:"mr-2 h-4 w-4"})," Add Entry"]})}),e.jsxs(g,{children:[e.jsxs(f,{children:[e.jsx(v,{children:U?"Edit Sitemap Entry":"Add New Sitemap Entry"}),e.jsx(w,{children:"Add or edit URLs to be included in your sitemap."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"url",children:"URL Path"}),e.jsx(c,{id:"url",value:B.url,onChange:e=>G({...B,url:e.target.value}),placeholder:"/example-page"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"priority",children:"Priority (0.0 - 1.0)"}),e.jsx(c,{id:"priority",type:"number",min:"0",max:"1",step:"0.1",value:B.priority,onChange:e=>G({...B,priority:parseFloat(e.target.value)})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"changefreq",children:"Change Frequency"}),e.jsxs(o,{value:B.changefreq,onValueChange:e=>G({...B,changefreq:e}),children:[e.jsx(h,{children:e.jsx(m,{})}),e.jsxs(p,{children:[e.jsx(u,{value:"always",children:"Always"}),e.jsx(u,{value:"hourly",children:"Hourly"}),e.jsx(u,{value:"daily",children:"Daily"}),e.jsx(u,{value:"weekly",children:"Weekly"}),e.jsx(u,{value:"monthly",children:"Monthly"}),e.jsx(u,{value:"yearly",children:"Yearly"}),e.jsx(u,{value:"never",children:"Never"})]})]})]})]}),e.jsxs(b,{children:[e.jsx(i,{variant:"outline",onClick:()=>{V(!1),M(null),G({url:"",priority:.5,changefreq:"weekly"})},children:"Cancel"}),e.jsx(i,{className:"bg-red-600 hover:bg-red-700",onClick:U?async()=>{try{if(!U)return;const{error:e}=await a.from("sitemap_entries").update({url:B.url.startsWith("/")?B.url:"/"+B.url,priority:B.priority,changefreq:B.changefreq}).eq("id",U.id);if(e)throw e;x({title:"Sitemap entry updated",description:"Entry has been updated successfully"}),M(null),V(!1),await T()}catch(e){x({title:"Error updating entry",description:e.message,variant:"destructive"})}}:async()=>{try{if(!B.url)return void x({title:"Validation error",description:"URL is required",variant:"destructive"});const{error:e}=await a.from("sitemap_entries").insert({url:B.url.startsWith("/")?B.url:"/"+B.url,priority:B.priority,changefreq:B.changefreq,is_dynamic:!1});if(e)throw e;x({title:"Sitemap entry added",description:"Entry has been added successfully"}),G({url:"",priority:.5,changefreq:"weekly"}),V(!1),await T()}catch(e){x({title:"Error adding entry",description:e.message,variant:"destructive"})}},children:U?"Save Changes":"Add Entry"})]})]})]})]})]}),D?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-600"})}):e.jsx("div",{className:"bg-white rounded-md border",children:e.jsxs(N,{children:[e.jsx(S,{children:e.jsxs(q,{children:[e.jsx(E,{children:"URL"}),e.jsx(E,{children:"Priority"}),e.jsx(E,{children:"Change Freq"}),e.jsx(E,{children:"Last Modified"}),e.jsx(E,{children:"Type"}),e.jsx(E,{children:"Status"}),e.jsx(E,{className:"text-right",children:"Actions"})]})}),e.jsx(C,{children:0===L.length?e.jsx(q,{children:e.jsx(k,{colSpan:7,className:"text-center py-6 text-gray-500",children:"No sitemap entries found"})}):L.map(r=>e.jsxs(q,{children:[e.jsx(k,{className:"font-medium",children:r.url}),e.jsx(k,{children:r.priority}),e.jsx(k,{children:r.changefreq}),e.jsx(k,{children:new Date(r.lastmod).toLocaleDateString()}),e.jsx(k,{children:e.jsx(_,{variant:r.is_dynamic?"secondary":"default",children:r.is_dynamic?"Dynamic":"Static"})}),e.jsx(k,{children:e.jsx(F,{checked:r.is_active,onCheckedChange:e=>(async(e,r)=>{try{const{error:i}=await a.from("sitemap_entries").update({is_active:r}).eq("id",e);if(i)throw i;x({title:"Entry updated",description:"Entry "+(r?"activated":"deactivated")}),await T()}catch(i){x({title:"Error updating entry",description:i.message,variant:"destructive"})}})(r.id,e)})}),e.jsx(k,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>(e=>{M(e),G({url:e.url,priority:e.priority,changefreq:e.changefreq}),V(!0)})(r),children:e.jsx(l,{className:"h-4 w-4"})}),!r.is_dynamic&&e.jsx(i,{variant:"outline",size:"sm",onClick:()=>(async e=>{try{const{error:r}=await a.from("sitemap_entries").delete().eq("id",e);if(r)throw r;x({title:"Entry deleted",description:"Sitemap entry has been removed"}),await T()}catch(r){x({title:"Error deleting entry",description:r.message,variant:"destructive"})}})(r.id),className:"text-red-600 hover:text-red-700",children:e.jsx(d,{className:"h-4 w-4"})})]})})]},r.id))})]})})]})};export{L as default};
